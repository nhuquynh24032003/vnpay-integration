<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Thanh toán</title>
</head>
<body>
<h1>Nạp tiền vào tài khoản</h1>
<form id="payment-form">
    <label for="amount">Amount:</label>
    <input type="number" id="amount" name="amount" placeholder="Enter amount" required>

    <label for="bankCode">Bank Code:</label>
    <input type="text" id="bankCode" name="bankCode" placeholder="Enter bank code" required>

    <button type="submit">Pay</button>
</form>
<script>
    // Lắng nghe sự kiện khi người dùng nhấn nút "Pay"
    document.getElementById('payment-form').addEventListener('submit', function(event) {
        event.preventDefault(); // Ngăn chặn form gửi dữ liệu theo cách thông thường

        // Lấy thông tin từ form
        const amount = document.getElementById('amount').value;
        const bankCode = document.getElementById('bankCode').value;

        // Gửi request đến backend để lấy URL thanh toán VNPay
        fetch(`/api/v1/payment/vn-pay?amount=${amount}&bankCode=${bankCode}`)
            .then(response => response.json())
            .then(data => {
                // Kiểm tra nếu có URL thanh toán trả về
                if (data.code === 200 && data.data.paymentUrl) {
                    // Điều hướng đến URL thanh toán
                    window.location.href = data.data.paymentUrl;
                } else {
                    alert("Payment failed. Please try again.");
                }
            })
            .catch(error => {
                alert("An error occurred. Please try again.");
            });
    });
</script>
</body>
</html>
